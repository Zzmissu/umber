% if ($is_faculty_edit){
%# The form that starts here ends in the edit.mhtml component.
<form class="edit" name="edit" method="POST" action="<%$r->uri%>">
% }
<div class="grade-h1">&nbsp;<span class="grade">grade : 
% if ($is_faculty_edit){
 <input type="text" width="8" name="edit_grade" 
        value="<% $work->grade || ' ' %>" />
% }
% else {
<& grade.mhtml, work => $work &>
% }
</span></div>
<h1>
<a href="<% $assign_uri %>"><% $assignment %></a>
<span style="font-size:85%;margin-left:1em">
<% $student %>'s work
</span>
</h1>
%# <% $msg %>
%# ======================================================================
<%args>
 $action => ''
 $submit_edit => ''
 $edit_grade  => ''
</%args>
<%init>
  my $work = $page->work or return;
  my $is_faculty = $page->role->ge_faculty;
  my $is_faculty_edit = ($is_faculty and $action eq 'edit');
  my $assignment = $work->assignment->name;
  # my $student = $work->person->name;  # BUG - sometimes is blank
  my $student = $work->person->get('name');  
  my $assign_uri = $page->course->directory_uri
		   . '/special/assignment?id=' . $work->assignment->id;

  ## -- debugging --
  #   my $msg = qq{
  # <pre>
  #  -- debug work.mhtml --
  #  submit_edit = '$submit_edit'
  #  is_faculty  = '$is_faculty'
  #  edit_grade  = '$edit_grade'
  # </pre>
  # }; 

  if ($submit_edit and $edit_grade and $is_faculty){ 
    $work->grade($edit_grade);
  }
</%init>
<%doc>
 $Id: work.mhtml 1694 2006-03-22 15:57:00Z mahoney $

Display a page title and user grade for student submitted work pages.

With the default wikiacademia.css style sheet, this is placed
at the top of the page with the grade on the far right.

 --------------------------------------------------------
 | Assignment Name      Jane Doe's work        grade: B |
 |                                                      |
 |                                                      |

This page also works in conjuction with the edit.mhtml component
to allow faculty to set the grade through the fairly kludgey 
mechanism of having the form named "edit" begin in either
in this component or edit.mhtml.

Since edit reloads the page when data is submitted,
this work component must be evaluated first if its
to catch the "submit" click.

</%doc>
